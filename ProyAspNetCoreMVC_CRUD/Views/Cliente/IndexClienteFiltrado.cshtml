@model IEnumerable<ProyAspNetCoreMVC_CRUD.Dto.ClienteResponseDto>

@{
    ViewData["Title"] = "IndexClienteFiltrado";
}

<h1>IndexClienteFiltrado</h1>

@if (TempData["mensaje"] != null)
{
    <div class="alert alert-primary alert-dismissible fade show" role="alert">
        <strong>@TempData["mensaje"]</strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<form class="mb-4 p-3 border rounded bg-light">
    <div class="row">
        @*input codigo cliente*@
        <div class="col-md-3">
            <label class="form-label">Código Cliente</label>
            <input type="text" name="cod_cli" class="form-control" value="@ViewBag.codCli" placeholder="Ej: C0001" />
        </div>

        @*Input correo*@
        <div class="col-md-3">
            <label class="form-label">Correo</label>
            <input type="text" name="cor_cli" class="form-control" value="@ViewBag.corCli" placeholder="nombre@gmail.com" />
        </div>

        @*DropDownList*@
        <div class="col-md-3">
            <label class="form-label">Distrito</label>
            <select name="cod_dist" class="form-select" asp-items="@ViewBag.distritos">
                <option value="" selected disabled>Seleccione un distrito</option>
            </select>
        </div>

        @*button*@
        <div class="col-md-3 d-flex align-items-end">
            <button type="submit" class="btn btn-primary me-2">
                <i class="bi bi-search"></i> Filtrar
            </button>
            <a asp-action="IndexClienteFiltrado" class="btn btn-secondary">Limpiar</a>
        </div>
    </div>
</form>

<p>
    <a asp-action="CreateCliente" class="btn btn-success">Nuevo (+)</a>
</p>

<table class="table table-striped table-hover table-bordered align-middle">
    <thead class="table-dark">
        <tr class="text-center">
            <th>
                @Html.DisplayNameFor(model => model.cod_cli)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.nom_cli)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.tel_cli)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.cred_cli)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.fec_nac)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.nom_dist) @*cambiamos cod_dist por nom_dist*@
            </th>
            <th>
                @Html.DisplayNameFor(model => model.eli_cli)
            </th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.cod_cli)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.nom_cli)
            </td>
            <td class="text-center">
                @if (item.tel_cli == null)
                {
                    <span class="text-muted">- - -</span>
                }
                else
                {
                    @Html.DisplayFor(modelItem => item.tel_cli)
                }
            </td>
            <td class="text-center">
                @if (item.cred_cli == null)
                {
                    <span class="text-muted">- - -</span>
                }
                else
                {
                    @Html.DisplayFor(modelItem => item.cred_cli)
                }
            </td>
            <td class="text-center">
                @if (item.fec_nac == null)
                {
                    <span class="text-muted">- - -</span>
                }
                else
                {
                    @Html.DisplayFor(modelItem => item.fec_nac)
                }
            </td>
            <td class="text-center">
                @Html.DisplayFor(modelItem => item.nom_dist) 
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.eli_cli)
            </td>
            <td class="text-center">
                @Html.ActionLink("Editar", "EditCliente", new { id = item.cod_cli }, new { @class = "btn btn-warning btn-sm" }) |
                @Html.ActionLink("Detalle", "DetailsCliente", new { id = item.cod_cli }, new { @class = "btn btn-info btn-sm" }) |
                @Html.ActionLink("Deshabilitar", "DeleteCliente", new { id = item.cod_cli }, new { @class = "btn btn-danger btn-sm" })
            </td>
        </tr>
}
    </tbody>
</table>

<div class="text-center mt-3 mb-5">
    @for (int i = 0; i < ViewBag.paginacion; i++)
    {
    // En el new { @class = ... } agregamos "m-1" para separarlos sin usar &nbsp;
    @Html.ActionLink(linkText: (i + 1).ToString(),
    actionName: "IndexClienteFiltrado",
        routeValues: new { nropagina = i, cod_cli = ViewBag.codCli, cor_cli = ViewBag.corCli, cod_dist = ViewBag.codDist },
        htmlAttributes: new { @class = "btn btn-primary m-1" }
        )
        }
</div>
